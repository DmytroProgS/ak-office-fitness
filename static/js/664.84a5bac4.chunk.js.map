{"version":3,"file":"static/js/664.84a5bac4.chunk.js","mappings":"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","sources":["hooks/useUserData.js","pages/Profile/Profile.js"],"sourcesContent":["// src/hooks/useUserData.js\r\nimport { useState, useEffect } from 'react';\r\nimport { doc, onSnapshot } from 'firebase/firestore';\r\nimport { useAuthState } from 'react-firebase-hooks/auth';\r\nimport { auth, db } from '../firebase'; \r\n\r\nconst useUserData = () => {\r\n    const [user, loadingAuth] = useAuthState(auth);\r\n    const [userData, setUserData] = useState(null);\r\n    \r\n    // Встановлюємо loadingData в true, поки не отримаємо перший результат з useAuthState\r\n    const [loadingData, setLoadingData] = useState(true); \r\n\r\n    useEffect(() => {\r\n        // 1. Чекаємо, поки useAuthState визначиться\r\n        if (loadingAuth) return; \r\n        \r\n        // Встановлюємо loadingData в true при зміні користувача, якщо він є.\r\n        // Це спрацює лише один раз після завантаження useAuthState.\r\n        if (user) {\r\n            setLoadingData(true); \r\n            const docRef = doc(db, 'users', user.uid);\r\n            \r\n            // onSnapshot встановлює постійне прослуховування даних користувача\r\n            const unsubscribe = onSnapshot(docRef, \r\n                (docSnap) => {\r\n                    if (docSnap.exists()) {\r\n                        setUserData({ ...docSnap.data(), uid: user.uid }); // ⭐ ПОКРАЩЕННЯ: Додаємо UID до даних\r\n                    } else {\r\n                        // Якщо документ не знайдено (хоча він є у вашій базі), повертаємо лише UID та email\r\n                        setUserData({ uid: user.uid, email: user.email }); \r\n                    }\r\n                    // ВАЖЛИВО: setLoadingData(false) має спрацювати після першої відповіді\r\n                    setLoadingData(false); \r\n                }, \r\n                (error) => {\r\n                    console.error(\"Помилка завантаження даних користувача:\", error);\r\n                    // Навіть у разі помилки ми припиняємо завантаження\r\n                    setLoadingData(false);\r\n                }\r\n            );\r\n\r\n            // Функція очищення (відписка від слухача)\r\n            return () => unsubscribe(); \r\n\r\n        } else {\r\n            // Користувач вийшов або не увійшов\r\n            setUserData(null);\r\n            setLoadingData(false);\r\n        }\r\n    }, [user, loadingAuth]); \r\n\r\n    return { userData, loading: loadingData };\r\n};\r\n\r\nexport default useUserData;","// src/pages/Profile/Profile.js\r\n\r\nimport React, { useState } from 'react';\r\nimport useUserData from '../../hooks/useUserData'; // Для отримання даних\r\nimport { doc, updateDoc } from 'firebase/firestore'; // Для оновлення даних\r\nimport { db } from '../../firebase'; // З'єднання з Firestore\r\n\r\nimport './Profile.css'; // Будемо створювати\r\n\r\nconst Profile = () => {\r\n    // Отримуємо дані користувача через хук\r\n    const { userData, loading: loadingData, error } = useUserData();\r\n    \r\n    // Стан для керування режимом редагування\r\n    const [isEditing, setIsEditing] = useState(false);\r\n    \r\n    // Стан для зберігання даних форми\r\n    const [formData, setFormData] = useState({ \r\n        firstName: '', \r\n        lastName: '', \r\n        birthDate: '', \r\n        height: '', \r\n        weight: '',\r\n        goal: '', \r\n    });\r\n    \r\n    // Стан для відображення повідомлень про оновлення\r\n    const [updateStatus, setUpdateStatus] = useState(null); // 'success', 'error', 'loading'\r\n\r\n    // ⭐ 1. Заповнення форми даними користувача при завантаженні\r\n    React.useEffect(() => {\r\n        if (userData) {\r\n            setFormData({\r\n                firstName: userData.firstName || '',\r\n                lastName: userData.lastName || '',\r\n                // Поле birthDate може бути порожнім, це нормально\r\n                birthDate: userData.birthDate || '', \r\n                height: userData.height || '',\r\n                weight: userData.weight || '',\r\n                goal: userData.goal || '',\r\n            });\r\n        }\r\n    }, [userData]);\r\n\r\n    // ⭐ 2. Обробка змін у формі\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [name]: value }));\r\n    };\r\n\r\n    // ⭐ 3. Обробка відправки форми (Збереження у Firestore)\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setUpdateStatus('loading');\r\n\r\n        try {\r\n            if (!userData || !userData.uid) {\r\n                throw new Error(\"Не знайдено UID користувача.\");\r\n            }\r\n\r\n            const userDocRef = doc(db, 'users', userData.uid);\r\n            \r\n            // Оновлюємо документ користувача в колекції 'users'\r\n            await updateDoc(userDocRef, formData);\r\n            \r\n            setUpdateStatus('success');\r\n            setIsEditing(false); \r\n            setTimeout(() => setUpdateStatus(null), 3000); \r\n            \r\n        } catch (err) {\r\n            console.error(\"Помилка оновлення профілю:\", err);\r\n            setUpdateStatus('error');\r\n            setTimeout(() => setUpdateStatus(null), 5000);\r\n        }\r\n    };\r\n\r\n    if (loadingData) return <div className=\"profile-container\"><p>Завантаження даних профілю...</p></div>;\r\n    if (error) return <div className=\"profile-container\"><p className=\"status-error\">Помилка завантаження: {error}</p></div>;\r\n    if (!userData) return <div className=\"profile-container\"><p>Дані користувача не знайдені.</p></div>;\r\n\r\n    return (\r\n        <div className=\"profile-container\">\r\n            <h1 className=\"page-title\">Персональний Профіль</h1>\r\n            \r\n            <form onSubmit={handleSubmit} className=\"profile-form\">\r\n                \r\n                {/* -------------------- БАЗОВІ ДАНІ (Тільки для читання) -------------------- */}\r\n                <div className=\"form-section\">\r\n                    <h2>Обліковий запис</h2>\r\n                    <div className=\"info-group\">\r\n                        <label>Електронна пошта:</label>\r\n                        <p className=\"info-value\">{userData.email || 'Не вказано'}</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* -------------------- РЕДАГОВАНІ ДАНІ -------------------- */}\r\n                <div className=\"form-section\">\r\n                    <h2>Особиста інформація</h2>\r\n                    \r\n                    {/* ІМ'Я */}\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"firstName\">Ім'я:</label>\r\n                        <input\r\n                            id=\"firstName\"\r\n                            name=\"firstName\"\r\n                            type=\"text\"\r\n                            value={formData.firstName}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                            placeholder=\"Ваше ім'я\"\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* ПРІЗВИЩЕ */}\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"lastName\">Прізвище:</label>\r\n                        <input\r\n                            id=\"lastName\"\r\n                            name=\"lastName\"\r\n                            type=\"text\"\r\n                            value={formData.lastName}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                            placeholder=\"Ваше прізвище\"\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* ДАТА НАРОДЖЕННЯ */}\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"birthDate\">Дата народження:</label>\r\n                        <input\r\n                            id=\"birthDate\"\r\n                            name=\"birthDate\"\r\n                            type=\"date\"\r\n                            value={formData.birthDate}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* ЗРІСТ */}\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"height\">Зріст (см):</label>\r\n                        <input\r\n                            id=\"height\"\r\n                            name=\"height\"\r\n                            type=\"number\"\r\n                            value={formData.height}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                            placeholder=\"Наприклад, 180\"\r\n                        />\r\n                    </div>\r\n\r\n                    {/* ВАГА */}\r\n                    <div className=\"form-group\">\r\n                        <label htmlFor=\"weight\">Вага (кг):</label>\r\n                        <input\r\n                            id=\"weight\"\r\n                            name=\"weight\"\r\n                            type=\"number\"\r\n                            value={formData.weight}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                            placeholder=\"Наприклад, 80\"\r\n                        />\r\n                    </div>\r\n                    \r\n                    {/* МЕТА */}\r\n                    <div className=\"form-group full-width\">\r\n                        <label htmlFor=\"goal\">Основна мета:</label>\r\n                        <textarea\r\n                            id=\"goal\"\r\n                            name=\"goal\"\r\n                            value={formData.goal}\r\n                            onChange={handleChange}\r\n                            readOnly={!isEditing}\r\n                            className={isEditing ? 'editable' : 'read-only'}\r\n                            placeholder=\"Ваша спортивна мета або мета покращення здоров'я\"\r\n                            rows=\"3\"\r\n                        ></textarea>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* -------------------- КНОПКИ ДІЙ -------------------- */}\r\n                <div className=\"profile-actions\">\r\n                    {updateStatus === 'loading' && <p className=\"status-message loading\">Оновлення даних...</p>}\r\n                    {updateStatus === 'success' && <p className=\"status-message success\">Дані успішно оновлено!</p>}\r\n                    {updateStatus === 'error' && <p className=\"status-message error\">Помилка оновлення. Спробуйте ще раз.</p>}\r\n\r\n                    {!isEditing ? (\r\n                        <button type=\"button\" onClick={() => setIsEditing(true)} className=\"edit-button\">\r\n                            Редагувати профіль\r\n                        </button>\r\n                    ) : (\r\n                        <>\r\n                            <button \r\n                                type=\"submit\" \r\n                                className=\"save-button\" \r\n                                disabled={updateStatus === 'loading'}\r\n                            >\r\n                                Зберегти зміни\r\n                            </button>\r\n                            <button \r\n                                type=\"button\" \r\n                                onClick={() => setIsEditing(false)} \r\n                                className=\"cancel-button\"\r\n                            >\r\n                                Скасувати\r\n                            </button>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Profile;"],"names":["useUserData","user","loadingAuth","useAuthState","auth","userData","setUserData","useState","loadingData","setLoadingData","useEffect","docRef","doc","db","uid","unsubscribe","onSnapshot","docSnap","exists","_objectSpread","data","email","error","console","loading","Profile","isEditing","setIsEditing","formData","setFormData","firstName","lastName","birthDate","height","weight","goal","updateStatus","setUpdateStatus","React","handleChange","e","name","value","target","prev","_jsx","className","children","_jsxs","onSubmit","async","preventDefault","Error","userDocRef","updateDoc","setTimeout","err","htmlFor","id","type","onChange","readOnly","placeholder","rows","_Fragment","disabled","onClick"],"ignoreList":[],"sourceRoot":""}