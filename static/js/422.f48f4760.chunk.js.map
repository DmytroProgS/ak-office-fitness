{"version":3,"file":"static/js/422.f48f4760.chunk.js","mappings":"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","sources":["pages/WeightControl/WeightControl.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { db, auth } from '../../firebase';\r\nimport { collection, addDoc, query, where, orderBy, onSnapshot, serverTimestamp, deleteDoc, doc } from 'firebase/firestore';\r\nimport { useAuthState } from 'react-firebase-hooks/auth';\r\nimport { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';\r\nimport './WeightControl.css';\r\n\r\nconst WeightControl = () => {\r\n    const [user] = useAuthState(auth);\r\n    const [weight, setWeight] = useState('');\r\n    const [history, setHistory] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (!user) return;\r\n\r\n        // Важливо: Цей запит вимагає індексу в Firebase!\r\n        const q = query(\r\n            collection(db, 'weightRecords'),\r\n            where('userId', '==', user.uid),\r\n            orderBy('timestamp', 'asc') \r\n        );\r\n\r\n        const unsubscribe = onSnapshot(q, (snapshot) => {\r\n            const data = snapshot.docs.map(doc => {\r\n                const firebaseData = doc.data();\r\n                const ts = firebaseData.timestamp?.toDate();\r\n                return {\r\n                    id: doc.id,\r\n                    weight: parseFloat(firebaseData.weight),\r\n                    date: ts ? ts.toLocaleDateString('uk-UA', { day: '2-digit', month: '2-digit' }) : '',\r\n                    fullDate: ts ? ts.toLocaleString('uk-UA') : 'Обробка...'\r\n                };\r\n            });\r\n            setHistory(data);\r\n            setLoading(false);\r\n        }, (error) => {\r\n            console.error(\"Помилка Firestore:\", error);\r\n            setLoading(false);\r\n        });\r\n\r\n        return () => unsubscribe();\r\n    }, [user]);\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        if (!user || !weight) return;\r\n\r\n        try {\r\n            await addDoc(collection(db, 'weightRecords'), {\r\n                userId: user.uid,\r\n                weight: parseFloat(weight),\r\n                timestamp: serverTimestamp()\r\n            });\r\n            setWeight('');\r\n        } catch (error) {\r\n            console.error(\"Помилка при збереженні:\", error);\r\n            alert(\"Помилка! Перевірте консоль (можливо, потрібен індекс)\");\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id) => {\r\n        if (window.confirm(\"Видалити цей запис?\")) {\r\n            await deleteDoc(doc(db, 'weightRecords', id));\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"loading-screen\">Завантаження статистики...</div>;\r\n\r\n    return (\r\n        <div className=\"wellness-container\">\r\n            <h1>КОНТРОЛЬ ВАГИ ТІЛА</h1>\r\n\r\n            <div className=\"weight-grid\">\r\n                {/* Форма вводу */}\r\n                <div className=\"weight-card\">\r\n                    <h3>Нове зважування</h3>\r\n                    <form onSubmit={handleSubmit} className=\"weight-form-inline\">\r\n                        <div className=\"input-wrapper\">\r\n                            <input \r\n                                type=\"number\" \r\n                                step=\"0.1\" \r\n                                value={weight} \r\n                                onChange={(e) => setWeight(e.target.value)} \r\n                                placeholder=\"00.0\"\r\n                                required \r\n                            />\r\n                            <span className=\"unit-label\">кг</span>\r\n                        </div>\r\n                        <button type=\"submit\" className=\"submit-button\">Зберегти</button>\r\n                    </form>\r\n                </div>\r\n\r\n                {/* Секція з графіком */}\r\n                <div className=\"weight-card chart-section\">\r\n                    <h3>Динаміка змін</h3>\r\n                    <div className=\"chart-box\">\r\n                        {history.length > 1 ? (\r\n                            <ResponsiveContainer width=\"100%\" height={200}>\r\n                                <LineChart data={history}>\r\n                                    <CartesianGrid strokeDasharray=\"3 3\" stroke=\"rgba(255,255,255,0.1)\" vertical={false} />\r\n                                    <XAxis dataKey=\"date\" stroke=\"#888\" fontSize={12} tickLine={false} />\r\n                                    <YAxis stroke=\"#888\" fontSize={12} tickLine={false} domain={['dataMin - 1', 'dataMax + 1']} />\r\n                                    <Tooltip \r\n                                        contentStyle={{ backgroundColor: '#1a1a1a', border: 'none', borderRadius: '8px' }}\r\n                                        itemStyle={{ color: '#4CAF50' }}\r\n                                    />\r\n                                    <Line \r\n                                        type=\"monotone\" \r\n                                        dataKey=\"weight\" \r\n                                        stroke=\"#4CAF50\" \r\n                                        strokeWidth={3} \r\n                                        dot={{ fill: '#4CAF50', r: 4 }} \r\n                                    />\r\n                                </LineChart>\r\n                            </ResponsiveContainer>\r\n                        ) : (\r\n                            <p className=\"placeholder-text\">Додайте записи, щоб побачити графік</p>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Таблиця історії */}\r\n            <div className=\"weight-history-section\">\r\n                <h3>Історія останніх зважувань</h3>\r\n                <div className=\"weight-table\">\r\n                    {[...history].reverse().map(record => (\r\n                        <div key={record.id} className=\"weight-row\">\r\n                            <span className=\"row-date\">{record.fullDate}</span>\r\n                            <span className=\"row-val\">{record.weight} кг</span>\r\n                            <button className=\"row-del\" onClick={() => handleDelete(record.id)}>×</button>\r\n                        </div>\r\n                    ))}\r\n                    {history.length === 0 && <p className=\"no-data\">Записів ще немає</p>}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default WeightControl;"],"names":["WeightControl","user","useAuthState","auth","weight","setWeight","useState","history","setHistory","loading","setLoading","useEffect","q","query","collection","db","where","uid","orderBy","unsubscribe","onSnapshot","snapshot","data","docs","map","doc","_firebaseData$timesta","firebaseData","ts","timestamp","toDate","id","parseFloat","date","toLocaleDateString","day","month","fullDate","toLocaleString","error","console","_jsx","className","children","_jsxs","onSubmit","async","e","preventDefault","addDoc","userId","serverTimestamp","alert","type","step","value","onChange","target","placeholder","required","length","ResponsiveContainer","width","height","LineChart","CartesianGrid","strokeDasharray","stroke","vertical","XAxis","dataKey","fontSize","tickLine","YAxis","domain","Tooltip","contentStyle","backgroundColor","border","borderRadius","itemStyle","color","Line","strokeWidth","dot","fill","r","reverse","record","onClick","window","confirm","deleteDoc","handleDelete"],"ignoreList":[],"sourceRoot":""}